-- OPERAÇÕES CONTEMPLADAS PELO CASO DE TESTE:
-- (COM ARQUIVO DE CLIENTES)
-- TRANSFERÊNCIA
-- BUSCAR TRANSAÇÃO
-- IMPRIMIR ARQUIVO DE CLIENTES
-- IMPRIMIR ARQUIVO DE TRANSAÇÕES
-- IMPRIMIR ÍNDICE DE CLIENTES
-- IMPRIMIR ÍNDICE DE CHAVES PIX
-- IMPRIMIR ÍNDICE DE TRANSAÇÕES
-- IMPRIMIR ÍNDICE DE TIMESTAMP

\echo file ARQUIVO_CLIENTES
66545678765;Maria Eugenia;12/04/1980;mariaeugenia@gmail.com;15998765645;0000004669.20;C66545678765&N15998765645&Emariaeugenia@gmail.com&Aabc80d38-ac29-48ab-9743-764d68b28493;##################################################################################99876556782;Gabriel Augusto;04/05/1997;ga.augusto@gmail.com;15997675654;0000224876.50;Ega.augusto@gmail.com&C99876556782&Ac6c10fd9-9fd3-447a-95bb-386215dceda1&N15997675654;####################################################################################44565434213;Geovana Santana;25/10/1994;ge.santana@gmail.com;16996543652;0000022349.00;C44565434213&Ege.santana@gmail.com&Ae5ba952e-f48d-48fd-a9ff-2818edd11c28&N16996543652;####################################################################################54654367865;Gustavo Almeida;19/11/1992;galmeida@gmail.com;14998786754;0078528347.84;Egalmeida@gmail.com&N14998786754&Ae543bbeb-b8c9-4d7f-beef-81899b79cea2&C54654367865;########################################################################################37567876542;Melissa Santos;13/04/1977;melissa@gmail.com;15998765435;0000002839.90;;#############################################################################################################################################################################14565436782;Melissa Pereira;19/09/1993;melissa@gmail.com;15997654738;0000023111.10;A4064b4e3-53ac-4469-a819-708177365752&C14565436782&Emelissa@gmail.com&N15997654738;##########################################################################################23465784759;Jose Santos;03/07/1968;josesantos@gmail.com;14998786754;0000036909.40;;#############################################################################################################################################################################
\echo file ARQUIVO_TRANSACOES
ERRO: Arquivo vazio
\echo index clientes_idx
[0]
[1] {54654367865, 0003}
[2]
[3]
[4]
[5] {99876556782, 0001}
[6] {44565434213, 0002}
[7]
[8]
[9] {66545678765, 0000}
[10] {14565436782, 0005}
[11] {23465784759, 0006}
[12]
[13]
[14]
[15] {37567876542, 0004}
[16]
\echo index chaves_pix_idx
[0] {15997654738, 14565436782} {ge.santana@gmail.com, 44565434213} {mariaeugenia@gmail.com, 66545678765}
[1]
[2]
[3] {54654367865, 54654367865} {c6c10fd9-9fd3-447a-95bb-386215dceda1, 99876556782} {melissa@gmail.com, 14565436782}
[4]
[5] {14565436782, 14565436782} {16996543652, 44565434213} {44565434213, 44565434213} {e543bbeb-b8c9-4d7f-beef-81899b79cea2, 54654367865}
[6] {15998765645, 66545678765} {4064b4e3-53ac-4469-a819-708177365752, 14565436782}
[7] {14998786754, 54654367865}
[8] {galmeida@gmail.com, 54654367865}
[9]
[10] {abc80d38-ac29-48ab-9743-764d68b28493, 66545678765}
[11] {99876556782, 99876556782}
[12] {e5ba952e-f48d-48fd-a9ff-2818edd11c28, 44565434213}
[13]
[14] {15997675654, 99876556782} {ga.augusto@gmail.com, 99876556782}
[15]
[16] {66545678765, 66545678765}
\echo index transacoes_idx
ERRO: Arquivo vazio
\echo index timestamp_cpf_origem_idx
ERRO: Arquivo vazio

-- gerando transferências
INSERT INTO transacoes VALUES ('15997654738', '54654367865', 984.7);
OK
INSERT INTO transacoes VALUES ('15998765645', '4064b4e3-53ac-4469-a819-708177365752', 59.5);
OK
INSERT INTO transacoes VALUES ('4064b4e3-53ac-4469-a819-708177365752', 'ge.santana@gmail.com', 2266);
OK
INSERT INTO transacoes VALUES ('galmeida@gmail.com', 'ga.augusto@gmail.com', 96);
OK
INSERT INTO transacoes VALUES ('16996543652', '15998765645', 68);
OK
INSERT INTO transacoes VALUES ('ga.augusto@gmail.com', 'abc80d38-ac29-48ab-9743-764d68b28493', 551);
OK
INSERT INTO transacoes VALUES ('44565434213', 'melissa@gmail.com', 582);
OK

-- usuário transferindo para si mesmo
INSERT INTO transacoes VALUES ('14565436782', '15997654738', 33);
ERRO: Chave PIX invalida
INSERT INTO transacoes VALUES ('abc80d38-ac29-48ab-9743-764d68b28493', '66545678765', 94);
ERRO: Chave PIX invalida

-- chave PIX não cadastrada
INSERT INTO transacoes VALUES ('josesantos@gmail.com', '14565436782', 49);
ERRO: Chave PIX invalida

-- valor inválido
INSERT INTO transacoes VALUES ('15997654738', '54654367865', -45);
ERRO: Valor invalido
INSERT INTO transacoes VALUES ('15998765645', '4064b4e3-53ac-4469-a819-708177365752', 0);
ERRO: Valor invalido
INSERT INTO transacoes VALUES ('4064b4e3-53ac-4469-a819-708177365752', 'ge.santana@gmail.com', -1.2);
ERRO: Valor invalido

-- saldo insuficiente
INSERT INTO transacoes VALUES ('15997654738', '54654367865', 20501.91);
ERRO: Saldo insuficiente


\echo file ARQUIVO_CLIENTES
66545678765;Maria Eugenia;12/04/1980;mariaeugenia@gmail.com;15998765645;0000005228.70;C66545678765&N15998765645&Emariaeugenia@gmail.com&Aabc80d38-ac29-48ab-9743-764d68b28493;##################################################################################99876556782;Gabriel Augusto;04/05/1997;ga.augusto@gmail.com;15997675654;0000224421.50;Ega.augusto@gmail.com&C99876556782&Ac6c10fd9-9fd3-447a-95bb-386215dceda1&N15997675654;####################################################################################44565434213;Geovana Santana;25/10/1994;ge.santana@gmail.com;16996543652;0000023965.00;C44565434213&Ege.santana@gmail.com&Ae5ba952e-f48d-48fd-a9ff-2818edd11c28&N16996543652;####################################################################################54654367865;Gustavo Almeida;19/11/1992;galmeida@gmail.com;14998786754;0078529236.54;Egalmeida@gmail.com&N14998786754&Ae543bbeb-b8c9-4d7f-beef-81899b79cea2&C54654367865;########################################################################################37567876542;Melissa Santos;13/04/1977;melissa@gmail.com;15998765435;0000002839.90;;#############################################################################################################################################################################14565436782;Melissa Pereira;19/09/1993;melissa@gmail.com;15997654738;0000020501.90;A4064b4e3-53ac-4469-a819-708177365752&C14565436782&Emelissa@gmail.com&N15997654738;##########################################################################################23465784759;Jose Santos;03/07/1968;josesantos@gmail.com;14998786754;0000036909.40;;#############################################################################################################################################################################
\echo file ARQUIVO_TRANSACOES
14565436782546543678650000000984.702021050116205866545678765145654367820000000059.502021050821534814565436782445654342130000002266.002021051808445054654367865998765567820000000096.002021051810372144565434213665456787650000000068.002021052718462999876556782665456787650000000551.002021052916081244565434213145654367820000000582.0020210604152855
\echo index clientes_idx
[0]
[1] {54654367865, 0003}
[2]
[3]
[4]
[5] {99876556782, 0001}
[6] {44565434213, 0002}
[7]
[8]
[9] {66545678765, 0000}
[10] {14565436782, 0005}
[11] {23465784759, 0006}
[12]
[13]
[14]
[15] {37567876542, 0004}
[16]
\echo index transacoes_idx
0021456543678220210501162058000014565436782202105180844500002##########################################################T***************00444565434213202106041528550006546543678652021051810372100036654567876520210508215348000199876556782202105291608120005T***************00144565434213202105271846290004#######################################################################################F000001*********
\echo index timestamp_cpf_origem_idx
00220210501162058145654367822021050821534866545678765##################################################T***************0042021051810372154654367865202105271846294456543421320210529160812998765567822021060415285544565434213T***************0012021051808445014565436782###########################################################################F000001*********

\q
